"0","# extract sale year. 1900 is coded for not sold residences. mutating these records to 2018 to predict the sale for current year"
"0","residential_clean_df <- residential_clean_df %>%"
"0","  mutate(sale_year =  if_else(year(residential_clean_df$SALEDATE)==1900,2018,"
"0","                              year(residential_clean_df$SALEDATE)))"
"0","# to check if the remodelling is done and ppulate the variable. Some of the remodelling happened after the sale date.We need to check if the remodelling happened before sale date to populare remodelled flag."
"0","residential_clean_df <- residential_clean_df %>%"
"0","  mutate(yr_remod_mod = if_else(is.na(YR_RMDL),2018,as.numeric(YR_RMDL))) %>%"
"0","  mutate(remodelled = as.factor(if_else(yr_remod_mod < sale_year,1,0))) %>%"
"0","  select(-yr_remod_mod)"
"0","# calculate age variable which is as of sale year."
"0","residential_clean_df <- residential_clean_df %>%"
"0","  mutate(age = pmin(if_else(sale_year - AYB <0, 999,  sale_year - AYB ),"
"0","                    if_else(sale_year - EYB <0, 999,  sale_year - EYB ), "
"0","                    if_else(sale_year - YR_RMDL <0, 999,  sale_year - YR_RMDL ), "
"0","                    na.rm=TRUE))"
"0","# excluding the date columns"
"0","residential_clean_df <- residential_clean_df %>%"
"0","  select(-AYB, -EYB, -YR_RMDL, -SALEDATE)"
